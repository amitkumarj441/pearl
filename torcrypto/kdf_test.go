package torcrypto

import (
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"
)

func TestKDFTOR(t *testing.T) {
	n := 53
	k := []byte("The cat sat on the mat")
	expect := []byte{
		0xa3, 0xc9, 0x7f, 0x12, 0xb3, 0x45, 0xa8, 0xf6, 0x2b, 0x04, 0x32, 0x3a,
		0x9f, 0x99, 0x99, 0x79, 0x74, 0xd6, 0xf6, 0x4e, 0x76, 0x8d, 0x58, 0x55,
		0xa9, 0xa3, 0x86, 0xd2, 0x0b, 0x56, 0x72, 0x24, 0x3a, 0x7e, 0xed, 0x62,
		0x2b, 0x38, 0xd1, 0x1b, 0xdf, 0x0e, 0x34, 0xa8, 0x78, 0x46, 0x07, 0x2b,
		0x5b, 0x7e, 0x2a, 0x7a, 0x8e,
	}
	got, err := KDFTOR(k, n)
	require.NoError(t, err)
	assert.Equal(t, expect, got)
}

func TestKDFTORTooLong(t *testing.T) {
	_, err := KDFTOR([]byte("k0"), 256*20+1)
	assert.Error(t, err)
}
